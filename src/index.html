<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<title> Gunnery Game</title>
		<script src="library/jquery-2.1.4.min.js"></script>

		<script type='text/javascript' src='class/object.js'></script>
		<script type='text/javascript' src='class/cannon.js'></script>
		<script type='text/javascript' src='action/board.js'></script>
		<script type='text/javascript' src='class/scenario.js'></script>
		<script type='text/javascript' src='class/fortress.js'></script>

		<script type='text/javascript' src='class/ball.js'></script>
		<script type='text/javascript' src='class/floor.js'></script>
		<script type='text/javascript' src='action/game2.js'></script>
		<style>
			body {
				padding: 0px;
				margin: 0px;
			}
		</style>  
	</head>
	
	<body>
		<div id='divNomes'>
			<div id='divNomeJogadorUm'>
				<p>Insira um nome com pelo menos 3 caracters e uma letra maiúscula para o Jogador Um:</p>
				<label>Nome: </label><input type='text' id='textName1'>
				<button onclick="validarNome(1)">Validar!</button>
				<br /><br />
				<div id='divJogUm' style='color:red;'></div>
			</div>
			<div id='divNomeJogadorDois'>
				<p>Insira um nome com pelo menos 3 caracters e uma letra maiúscula para o Jogador Dois:</p>
				<label>Nome: </label><input type='text' id='textName2'>
				<button onclick="validarNome(2)">Validar!</button>
				<br /><br />
				<div id='divJogDois' style='color: red;'></div>
			</div>
		</div>

		<div id='divJogo'>
		</div>
		
		<div id='divVida'>
		</div>

		<div id='divFinalJogo'>
			Aqui é a tela de final do jogo!
		</div>
	
	</body>
</html>

<script>
	var isNomesValidadoJogUm = false;
	var isNomesValidadoJogDois = false;
	var nomeJogadorUm;
	var nomeJogadorDois;
	var arrayNroCliques = [];

	$(document).ready(function() {
		$("#divJogo").hide();
		$("#divVida").hide();
		$("#divFinalJogo").hide();
	});

	function diminuirVida(jogador) 
	{
		var vida = $("#vidaJogador" + jogador).val();

		arrayNroCliques.push(1);
		
		$("#vidaJogador" + jogador).val(vida -1);

		if ($("#vidaJogador" + jogador).val() == 0) {
			alert("Fim de jogo!");
			$("#divJogo").remove();
			$("#divVida").remove();
			$("#gameCanvas").remove();
			$("#divFinalJogo").show();
			
			nomeGanhador = jogador == 0 ? nomeJogadorDois : nomeJogadorUm;
			
			$("#divFinalJogo").html("<center><h1>" + nomeGanhador + "venceu o jogo!" + "</h1></center>");
			
			soma = somarNroRodadas(arrayNroRounds);
			alert(soma);
			
			var nroCliques = arrayNroCliques.reduce(function(a, b) {
				return a + b;
			});
		}
	}

	function validarNome(jogador) 
	{
		var validated = true;

		if (jogador == 1)
	    	var nome = $("#textName1").val();
	    else
	    	var nome = $("#textName2").val();

	    if (nome.length >= 3) 
	    {
		    if (!nome.match(/^(?=.*[A-Z])/))
		    	validated = false;
		}
		else
			validated = false;

		if (validated == false)
			if (jogador == 1)
				$("#divJogUm").html('Você precisa inserir um nome com pelo menos 3 letras e uma maiúscula!');
			else
				$("#divJogDois").html('Você precisa inserir um nome com pelo menos 3 letras e uma maiúscula!');
		
			
		else 
		{
			if (jogador == 1) 
			{
				$("#divJogUm").html('Nome validado com sucesso!');
				nomeJogadorUm = nome;
			}
			else
			{
				nomeJogadorDois = nome;
				$("#divJogDois").html('Nome validado com sucesso!');
			}
		}

		if (jogador == 1)
			isNomesValidadoJogUm = validated;
		else
			isNomesValidadoJogDois = validated;

		if (isNomesValidadoJogUm && isNomesValidadoJogDois)
		{
			alert("Nomes dos jogadores estão OK!");
			$("#divNomes").remove();
			$("#divJogo").html("<table><tr><td>Jogador 1: " + nomeJogadorUm + "</td><td>" + "Jogador 2: " + nomeJogadorDois + "</tr></table>");
			$("#divJogo").show();
			$("#divVida").show();
			currentGame = new gameSpace.Match().initLifes(5);
			currentGame.startMatch();
		}
	}
</script>
